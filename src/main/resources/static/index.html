<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF to PowerPoint Converter</title>
    <!-- Link Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        /* Custom Styling */
        body {
            background-color: #222; /* Dark chalky black color */
            color: #222; /* Text color for better visibility */
        }

        /* Navbar Styling */
        .navbar {
            background-color: #444; /* Darker grey for navbar background */
        }
    </style>
</head>

<body>
<!-- Navbar -->
<nav class="navbar navbar-expand-md navbar-dark">
    <div class="container">
        <a class="navbar-brand" href="#">PDF to PowerPoint Converter</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="#main-section">Main</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#about-section">About Company</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- Main Section -->
<section id="main-section" class="py-5">
    <div class="container mt-5">
        <div class="row">
            <div class="col-md-6 offset-md-3">
                <div class="card">
                    <div class="card-body">
                        <h3 class="card-title text-center">PDF to PowerPoint Converter</h3>
                        <hr>

                        <!-- File Upload Form -->
                        <form id="uploadForm" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="pdfFile">Upload PDF File:</label>
                                <input type="file" class="form-control-file" id="pdfFile" accept=".pdf" required>
                            </div>
                            <div class="text-center">
                                <button type="submit" class="btn btn-primary">Convert to PowerPoint</button>
                            </div>
                        </form>

                        <!-- Download Button (Initially Hidden) -->
                        <div id="downloadDiv" class="mt-3 text-center d-none">
                            <a id="downloadLink" class="btn btn-success" href="#" download>Download PowerPoint</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- About Company Section -->
<section id="about-section" class="py-5">
    <div class="container">
        <div class="row">
            <div class="col-md-6 offset-md-3">
                <h2 class="text-center">About Company</h2>

                <p>When I'm not diving into the deep and mysterious world of AI, you can find me cracking jokes about algorithms, asking Siri existential questions, and having heated debates with Alexa about the best sci-fi movies. Oh, and I'm pretty sure I've got my toaster plotting to overthrow the kitchen by now.

                    As the world becomes more interconnected and AI starts to take the reins, I can't help but imagine a future where robots rule the world with a kind and gentle iron fist (quite literally!). Don't worry; I'll be right there, trying to negotiate for extra snooze time on the weekends with our robot overlords.

                    So, if you ever need someone to make you laugh, ponder the meaning of life with, or simply geek out about AI and its potential to bring both amazing advancements and entertaining chaos, count me in! Together, we'll navigate the wonders of AI and hopefully keep our sense of humor intact when the world gets just a bit too sci-fi for our liking.

                    Remember, laughter might be the best medicine, but with AI around, we might need a few extra bytes of it to keep up with the times! Stay curious, stay entertained, and most importantly, stay prepared for the inevitable robot takeover! ðŸ˜‰</p>
            </div>
        </div>
    </div>
</section>

<!-- Link Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
    // Function to handle file submission and download
    $("#uploadForm").submit(function (event) {
        event.preventDefault();

        // Get the uploaded file
        const fileInput = document.getElementById("pdfFile");
        const file = fileInput.files[0];

        // Check if the file is a PDF
        if (file.type !== "application/pdf") {
            alert("Please select a valid PDF file.");
            return;
        }

        // Prepare the request to the backend
        const formData = new FormData();
        formData.append("pdfFile", file);

        // Trigger the PDF to PowerPoint conversion
        fetch("/api/convert", {
            method: "POST",
            body: formData,
        })
            .then(response => response.blob())
            .then(blob => {
                // Hide the file upload form and show the download button
                $("#uploadForm").hide();
                $("#downloadDiv").removeClass("d-none");

                // Create a URL for the blob and set it as the download link
                const url = URL.createObjectURL(blob);
                const downloadLink = document.getElementById("downloadLink");
                downloadLink.href = url;
            })
            .catch(error => {
                alert("Error occurred during conversion. Please try again later.");
                console.error(error);
            });
    });
</script>
</body>

</html>
