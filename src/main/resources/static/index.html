<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Research2Slides</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://kit.fontawesome.com/bc35fc51fc.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    
</head>

<body>

    <div class="container">
        
        <!-- Navigation Bar -->
        <nav class="bx navbar">
            <div class="header-logo">
                <img src="header-logo.png" alt="">
            </div>
            <div class="header-link">

                <a href="https://github.com/Rayaan-khan428/Research2SlidesWebApp">GitHub</a>
                <a href="">SRS</a>
                <a href="">Design Doc</a> 

            </div>
        </nav>

        <!-- Hero Section, Image & short text with Header -->
        <div class="bx hero">

            <div class="hero-1 hero-cta">
                <h1>Research2Slides.com</h1>
                <h3>Introducing our cutting-edge PDF to PPTX converter</h3>
                <p>Your ultimate solution for seamless document transformation! Say goodbye to tedious manual copying and pasting, as our powerful program empowers you to effortlessly convert PDF files into dynamic PowerPoint presentations with just a few clicks.</p>
                <p> Whether you're a professional looking to streamline your workflow or a student seeking to elevate your presentations, our tool provides unrivaled accuracy, ensuring a polished final result. Unlock the full potential of your documents today!</p></p>
                <button type="button">Try Below!</button>
            </div>

            <div class="hero-1 hero-image">

                <img src="https://hislide.io/wp-content/uploads/2023/01/00-Fusion-template-for-PowerPoint-and-Keynote.webp" alt="something">

            </div>
        </div>

        <!-- Features -->
        <div class="bx content">
            <h2>Features</h2>
            <div class="content-info">
                <div>
                    <img src="ai-powered.png" alt="">
                    <p>Powered by Co:here nlp</p>
                </div>
                <div>
                    <img src="fast.webp" alt="">
                    <p>Conversion in Seconds</p>
                </div>
                <div>
                    <img src="free.png" alt="">
                    <p>No Suprises, it's free!</p>
                </div>
                <div>
                    <img src="customizable.png" alt="">
                    <p>Easily Customizable</p>
                </div>
            </div>
        </div>

        <div class="conversion-section">

            <h2>Convert here!</h2>

            <div class="upload-box" id="uploadBox">
              <input type="file" id="pdfInput" accept=".pdf">
              <p>Drag and drop your PDF here or click to select a file.</p>
            </div>
            <div class="design-section" id="designSection" style="display: none;">
              <h2>Select a design:</h2>
              <div class="design-options">
                <label>
                    <input type="radio" name="design" value="design1">
                    Design 1
                </label>
                
                <label>
                    <input type="radio" name="design" value="design2">
                    Design 2
                </label>

                <label>
                    <input type="radio" name="design" value="design3">
                    Design 3
                </label>

                <label>
                    <input type="radio" name="design" value="design4">
                    Design 4
                </label>

                <label>
                    <input type="radio" name="design" value="design5">
                    Design 5
                </label>

                <label>
                    <input type="radio" name="design" value="design6">
                    Design 6
                </label>

                <label>
                    <input type="radio" name="design" value="design7">
                    Design 7
                </label>

                <label>
                    <input type="radio" name="design" value="design8">
                    Design 8
                </label>

                <!-- Add more design options here -->
              </div>
              <button id="convertBtn">Run Conversion</button>
              <div class="loading" id="loading" style="display: none;">
                <img src="https://i.gifer.com/origin/34/34338d26023e5515f6cc8969aa027bca_w200.gif" alt="Loading...">
                <p>Converting...</p>
              </div>
            </div>
            <a id="downloadLink" style="display: none;">Download PowerPoint</a>
          </div>
              

        <div class="bx content">
            <h2>Designs You can choose from</h2>
            <div class="design-info">
                <div>
                    <img src="design-covers/design1.png" alt="">
                    <p>Design 1</p>
                </div>
                <div>
                    <img src="design-covers/design2.png" alt="">
                    <p>Design 2</p>
                </div>
                <div>
                    <img src="design-covers/design3.png" alt="">
                    <p>Design 3</p>
                </div>
                <div>
                    <img src="design-covers/design4.png" alt="">
                    <p>Design 4</p>
                </div>
                <div>
                    <img src="design-covers/design5.png" alt="">
                    <p>Design 5</p>
                </div>
                <div>
                    <img src="design-covers/design6.png" alt="">
                    <p>Design 6</p>
                </div>
                <div>
                    <img src="design-covers/design7.png" alt="">
                    <p>Design 7</p>
                </div>
                <div>
                    <img src="design-covers/design8.png" alt="">
                    <p>Design 8</p>
                </div>
            </div>
        </div>

        <div class="bx footer">
            <p>Copyright Â© The Odin Project 2021</p>
        </div>
    </div>

    <script>

document.addEventListener("DOMContentLoaded", function () {
  const uploadBox = document.getElementById("uploadBox");
  const designSection = document.getElementById("designSection");
  const convertBtn = document.getElementById("convertBtn");
  const loading = document.getElementById("loading");
  const downloadLink = document.getElementById("downloadLink");
  let selectedDesign = null;
  let pdfFile = null;

  // Event listeners for file upload and drag-and-drop
  uploadBox.addEventListener("dragover", (e) => {
    e.preventDefault();
    uploadBox.classList.add("highlight");
  });

  uploadBox.addEventListener("dragleave", () => {
    uploadBox.classList.remove("highlight");
  });

  uploadBox.addEventListener("drop", (e) => {
    e.preventDefault();
    uploadBox.classList.remove("highlight");
    handleFileUpload(e.dataTransfer.files[0]);
  });

  document.getElementById("pdfInput").addEventListener("change", (e) => {
    handleFileUpload(e.target.files[0]);
  });

  // Handle file upload
  function handleFileUpload(file) {
    if (file && file.type === "application/pdf") {
      pdfFile = file;
      uploadBox.innerHTML = `<p>Selected file: ${file.name}</p>`;
      designSection.style.display = "block";
    } else {
      alert("Please select a valid PDF file.");
    }
  }

  // Event listener for design selection
  const designOptions = document.querySelectorAll('input[type="radio"]');
  designOptions.forEach((option) => {
    option.addEventListener("change", (e) => {
      selectedDesign = e.target.value;
    });
  });

  // Event listener for conversion button click
  convertBtn.addEventListener("click", () => {
    if (selectedDesign && pdfFile) {
      loading.style.display = "flex";
      convertBtn.disabled = true;

      // Prepare data to send in the request
      const formData = new FormData();
      formData.append("design", selectedDesign);
      formData.append("pdfFile", pdfFile);

      // Send the API request using Axios
      axios
        .post("/api/convert", formData, {
          headers: {
            "Content-Type": "multipart/form-data",
          },
          responseType: "arraybuffer", // Tell Axios to handle response as binary data
        })
        .then((response) => {
          loading.style.display = "none";
          convertBtn.disabled = false;

          // Create a Blob from the response data
          const blob = new Blob([response.data], { type: "application/vnd.openxmlformats-officedocument.presentationml.presentation" });

          // Create a download link for the converted PowerPoint
          const downloadUrl = URL.createObjectURL(blob);
          downloadLink.href = downloadUrl;
          downloadLink.download = "converted_presentation.pptx";
          downloadLink.style.display = "block";
        })
        .catch((error) => {
          loading.style.display = "none";
          convertBtn.disabled = false;
          console.error("Error occurred during conversion:", error);
          alert("Error occurred during conversion. Please try again later.");
        });
    } else {
      alert("Please select a design and upload a PDF file.");
    }
  });
});



    </script>

</body>
</html>


